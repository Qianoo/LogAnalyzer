<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analyzer Result</title>
    <script src="https://cdn.jsdelivr.net/npm/markdown-it@13.0.1/dist/markdown-it.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        h1 {
            text-align: center;
            padding: 10px;
            margin: 0;
            background-color: #f5f5f5;
            font-size: 1.5rem;
        }

        #container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        #keyword-list {
            width: 20%;
            background-color: #f8f9fa;
            border-right: 1px solid #dee2e6;
            overflow-y: auto;
            padding: 15px;
        }

        .right-panel {
            width: 80%;
            display: flex;
            flex-direction: column;
        }

        #log-display {
            height: 70%;
            overflow-y: auto;
            padding: 15px;
            border-bottom: 1px solid #dee2e6;
        }

        #analysis-result {
            height: 30%;
            overflow-y: auto;
            padding: 15px;
            background-color: #ffffff;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .keyword {
            margin: 8px 0;
            padding: 8px 12px;
            background-color: #fff;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .keyword:hover {
            background-color: #e9ecef;
        }

        .highlight {
            background-color: #fff3cd;
            padding: 2px 0;
        }

        .line-number {
            color: #6c757d;
            margin-right: 10px;
            -webkit-user-select: none;
               -moz-user-select: none;
                    user-select: none;
        }

        .keyword-block {
            margin: 8px 0;
            padding: 6px;
            background-color: #f8f9fa;
            border-radius: 4px;
        }

        .keyword-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .keyword-tag {
            font-size: 0.8rem;
            padding: 2px 6px;
            margin: 2px;
            border-radius: 3px;
            background-color: #e7f3ff;
            border: 1px solid #b3d7ff;
            cursor: pointer;
        }

        .keyword-tag:hover {
            background-color: #cce5ff;
        }

        .keyword-tag .line-info {
            font-size: 0.8em;
            color: #666;
            margin-left: 4px;
        }

        .line-highlight {
            background-color: #fff3cd;
            animation: highlight 2s;
        }

        @keyframes highlight {
            from {
                background-color: #ffeeba;
            }

            to {
                background-color: #fff3cd;
            }
        }

        .block-header {
            padding: 5px 10px;
            background-color: #f0f0f0;
            border-bottom: 1px solid #ddd;
            font-weight: bold;
            margin-bottom: 10px;
        }

        #filter-container {
            padding: 8px;
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            background-color: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
        }

        .filter-tag {
            font-size: 0.8rem;
            padding: 2px 8px;
            border-radius: 4px;
            cursor: pointer;
            background-color: #e9ecef;
            border: 1px solid #dee2e6;
        }

        .filter-tag.active {
            background-color: #28a745;
            color: white;
        }

        .filter-tag.inactive {
            background-color: #e9ecef;
            color: #666;
        }

        .markdown {
            padding: 0.8rem;
            font-size: 0.9rem;
        }

        .markdown h1 {
            font-size: 1.4em;
            margin-top: 0.8em;
            margin-bottom: 0.4em;
        }

        .markdown h2 {
            font-size: 1.2em;
            margin-top: 0.8em;
            margin-bottom: 0.4em;
        }

        .markdown h3 {
            font-size: 1.1em;
            margin-top: 0.8em;
            margin-bottom: 0.4em;
        }

        .markdown ul,
        .markdown ol {
            padding-left: 1.5em;
            margin-bottom: 0.8em;
        }

        .markdown li {
            margin-bottom: 0.3em;
        }

        .markdown code {
            background-color: #f0f0f0;
            padding: 0.2em 0.4em;
            border-radius: 3px;
            font-family: monospace;
        }

        .markdown pre {
            background-color: #f5f5f5;
            padding: 1em;
            border-radius: 5px;
            overflow-x: auto;
            margin: 1em 0;
        }

        .markdown blockquote {
            border-left: 4px solid #ddd;
            padding-left: 1em;
            margin: 1em 0;
            color: #666;
        }

        .markdown p {
            margin-bottom: 0.8em;
        }

        /* 添加容器样式 */
        .split-container {
            display: flex;
            flex-direction: column;
            height: calc(100vh - 150px);
            /* 减去其他元素的高度 */
            position: relative;
        }

        /* 日志显示窗口 */
        #log-display {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
            min-height: 100px;
            /* 最小高度 */
        }

        /* 可拖动的分隔条 */
        .resizer {
            width: 100%;
            height: 8px;
            background: #f0f0f0;
            cursor: row-resize;
            border-top: 1px solid #ddd;
            border-bottom: 1px solid #ddd;
        }

        /* 分隔条中间的线 */
        .resizer::after {
            content: '';
            display: block;
            width: 30px;
            height: 2px;
            background: #999;
            margin: 3px auto;
        }

        /* 分析结果窗口 */
        #analysis-result {
            height: 200px;
            /* 初始高度 */
            overflow-y: auto;
            padding: 10px;
            min-height: 100px;
            /* 最小高度 */
        }

        /* 拖动时的遮罩层 */
        .resize-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: none;
        }

        /* 添加进度条样式 */
        .progress-container {
            display: none;
            /* 默认隐藏 */
            width: 100%;
            padding: 10px;
            background-color: #f5f5f5;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .progress-bar {
            width: 0%;
            height: 4px;
            background-color: #4CAF50;
            transition: width 0.3s ease;
        }

        .progress-text {
            font-size: 0.8rem;
            color: #666;
            text-align: center;
            margin-top: 4px;
        }

        /* 添加重复信息的样式 */
        .duplicate-info {
            background-color: #f0f0f0;
            padding: 4px 8px;
            margin-bottom: 4px;
            border-radius: 4px;
            font-size: 0.9em;
            color: #666;
        }

        .select {
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-right: 1rem;
        }

        .flex {
            display: flex;
        }

        .justify-between {
            justify-content: space-between;
        }

        .mb-4 {
            margin-bottom: 1rem;
        }

        .control-panel {
            display: flex;
            align-items: center;
            gap: 10px;
            /* 控制按钮之间的间距 */
            padding: 10px;
            background-color: #f5f5f5;
            border-bottom: 1px solid #ddd;
        }

        .select {
            min-width: 120px;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .btn-primary {
            background-color: #4CAF50;
            color: white;
        }

        .btn-primary:hover {
            background-color: #45a049;
        }

        .btn-primary:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }

        .filter-tag {
            display: inline-block;
            padding: 4px 8px;
            margin: 4px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-tag.active {
            background-color: #4CAF50;
            color: white;
        }

        .filter-tag.inactive {
            background-color: #f0f0f0;
            color: #666;
        }

        .highlight {
            background-color: #fff3cd;
            border-left: 3px solid #ffc107;
        }

        .keyword-tag {
            display: inline-block;
            padding: 4px 8px;
            margin: 4px;
            border-radius: 4px;
            cursor: pointer;
            background-color: #f0f0f0;
            color: #666;
            transition: all 0.3s ease;
        }

        .keyword-tag:hover {
            background-color: #e0e0e0;
        }

        .keyword-tag.active {
            background-color: #4CAF50;
            color: white;
        }

        .keyword-block {
            margin-bottom: 10px;
        }

        .keyword {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .keyword-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .highlight {
            background-color: #fff3cd;
            border-left: 3px solid #ffc107;
        }
    </style>
  <script type="module" crossorigin>(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))u(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&u(n)}).observe(document,{childList:!0,subtree:!0});function l(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function u(r){if(r.ep)return;r.ep=!0;const a=l(r);fetch(r.href,a)}})();function K(i){const r=["Segmentation fault","core dumped","Bus error","undefined reference","stack overflow","double free","invalid pointer","malloc failed","SIGABRT","SIGSEGV","NullPointerException","ArrayIndexOutOfBoundsException","ClassNotFoundException","NoSuchMethodError","IllegalArgumentException","OutOfMemoryError","StackOverflowError","ClassCastException","ANR","FATAL EXCEPTION","ActivityManager: Force finishing activity","E/AndroidRuntime","W/ActivityThread","StrictMode","kernel panic","Oops","BUG:","Call Trace","slab corruption","general protection fault","I/O error","bad page state","Error","error","Critical","Failed","Exception","Timeout","Permission denied","Device not found"],a=new Map;for(const e of r)a.set(e,{regex:new RegExp(`\\b${e}\\b`),length:e.length});const n=new Set,o=new Map,c=i.split(`
`),t=c.length,m=new Array(15);let h=0,s=null,y=-1;function S(e){for(const[g,{regex:p,length:f}]of a)if(e.length>=f&&e.includes(g)&&p.test(e))return{keyword:g,matchedText:g};return null}function A(e,g){const p=e.indexOf(g);if(p===-1)return null;let f=p;for(;f>0&&e[f-1]!==" ";)f--;let L=p+g.length;for(;L<e.length&&e[L]!==" ";)L++;return{before:e.slice(f,p),after:e.slice(p+g.length,L)}}function x(e,g){const p=c[e];return`${e}-${g}-${p}`}for(let e=0;e<t;e++){const g=c[e];if(n.has(e))continue;m[h%m.length]=g,h++;const p=S(g);if(p){const{keyword:f,matchedText:L}=p;if(e===y+1){y=e,s&&(s.lines.push(g),n.add(e));continue}if(!A(g,L))continue;y=e;const I=x(e,Math.min(e+5,t));let C=o.get(I);if(C){C.lineNumbers.add(e),C.duplicateCount++,n.add(e);continue}const N=new Array(Math.min(300,6));let B=0;for(let b=Math.max(0,h-10);b<h;b++)N[B++]=m[b%m.length];C={startLine:Math.max(0,e-10),endLine:Math.min(e+5,t),keywords:[f],lines:N.slice(0,B),duplicateCount:1,lineNumbers:new Set([e]),summaryLine:g},o.set(I,C),s?e>s.endLine||s.lines.length>=300?s=C:(s.keywords.push(f),s.lines.push(g),s.lineNumbers.add(e)):s=C,n.add(e)}else s&&s.lines.length<300&&(s.lines.push(g),e>=s.endLine&&(s=null,h=0,y=-1))}const w=Array.from(o.values());for(const e of w){const g=Array.from(e.lineNumbers);g.sort((p,f)=>p-f),e.summary=`此日志模式重复出现了 ${e.duplicateCount} 次`,e.summaryLine=`<div class="log-line">行 ${g.join("、")}: ${e.summaryLine}</div>`,e.lines=e.lines.map(p=>`<div class="log-line">${p}</div>`)}return w}const H={defaultLogAnalysis:`作为日志分析专家,请你分析日志,推测可能出问题的模块,根据提供的owner联系列表,推测出模块的owner和Manager(最多输出3个可能的联系人),并按照下面的模板回复：

1. 概述
- 日志类型
- 涉及组件

2. 原因分析
- 问题根源
- 关联性分析
- 系统模块定位

3. 解决方案
- 修复建议

4.可能的Owner和Manager

请注意这是owner联系列表,你需要在owner联系列表中找到可能的联系人:
Platform (Manager: Ethan Wells)
uboot: Liam Scott
bl2: Liam Scott
bl31: Liam Scott
kernel: Noah Peterson
bl30: Caleb Dawson
Storage drivers: Oliver Hayes
gpio: Henry Sutton
pinctrl: Henry Sutton
i2c: Nathan Cole
clk tree: Nathan Cole
spi: Lucas Fisher
spi nand: Lucas Fisher
spi nor flash: Lucas Fisher
pwm: Adrian Tucker
emmc: Logan Reed
sdio: Mason Bennett
WIFI/BT: Connor Jennings
wifi driver: Ryan Mitchell
wifi driver (freertos): Brandon Lee
wifi driver (buildroot): Dylan Carter
bt driver: Owen Greene
secureos: Wesley Bryant, Blake Thornton, Joel Graham
freertos: Vincent Harper
usb: Austin Brooks
ethernet phy: Evan Wallace
uart: Tyler Newton, Alex Morris

Audio (Manager: Julian Adams)
audio driver: Daniel Lawson
audio hal: Daniel Lawson
dsp driver: Justin Cooper
audio eq/drc: Sean Wright
dolby/dts MS12: Zachary Foster

Display / Graphic (Manager: Simon Grant)
OSD: Brian Porter
camera ISP: Leo Benson
Graphic: Jack Anderson
buildroot DRM: Aaron Price
NPU driver: Xavier Vaughn
NPU APP: Derek Sullivan
OSD driver: Patrick Newman
GE2D/GDC: Ian Chambers
PIP: Marcus Elliott
ISP driver: Wesley Clarke, Chase Hughes, Caleb Perkins
camera hal: Vincent Curtis
camera IQ: Ethan Greene

HDMI (Manager: Frank Dawson)
Panel Cvbs: Oliver Stone
HDMI TX: Eric Lawson
HDMI RX: Levi Baldwin, Nathan Spencer

Media (Manager: Zachary Miller)
decoder: Hugo Brooks
Android player: Maxwell Grant
DRM player: Spencer Holland, Tristan Coleman

Android AE (Manager: Taylor Young)
TV framework: Keith Simmons
CEC: Andrew Ford
camera apk: Jesse Duncan
Android System: Miles Parker

Android 公版 (Manager: Thomas Quinn)
OTT release: Wyatt Henderson
TV release: Levi Hunter
DS release: Felix Norton
system control: Oscar Bennett
burning tools: Gregory Hayes
OTA: Jordan Ellis

Buildroot (Manager: George Franklin)
RDK: Sebastian Reeves, Damian Walsh
IPC SDK: Jared Dawson, Ethan Hawkins, Russell Chapman, Bryce Sullivan, Connor Woods
ISP/encoder SDK: Preston Newman

HW (Manager: Lucas Freeman)
DDR SW: Jeremy Rhodes, Desmond Garrett
IPC HW: Cameron Tate
IPC/OTT HW: Dylan Perry
FAE HW: Adrian Foster
TV HW: Ivan Stevenson
HW: Wesley Norton
`,detailedLogAnalysis:`作为日志分析专家,请详细分析以下日志：

1. 日志概述
- 日志类型和格式
- 时间范围分析
- 涉及的系统组件
- 日志严重程度分布

2. 问题诊断
- 错误模式识别
- 异常事件时序
- 系统状态分析

3. 根因分析
- 直接原因
- 潜在因素
- 系统瓶颈
- 组件间依赖

4. 解决方案
- 即时修复建议
- 长期优化方案
- 监控建议
- 预防措施`,simpleLogAnalysis:`简要分析此日志：
1. 问题描述
2. 原因分析
3. 解决方案`};function G(i="defaultLogAnalysis"){return`${H.owner_prompt}

${H[i]}`}async function X(){try{const d=await(await fetch("/config/custom-prompts.json")).json();Object.assign(H,d)}catch(i){console.warn("Failed to load custom prompts:",i)}}X();let T=[],O=[],E=new Map,M=null;const $=document.getElementById("filter-container"),q=document.getElementById("keyword-list"),P=document.getElementById("log-display"),J=window.markdownit({html:!0,linkify:!0,typographer:!0});window.addEventListener("message",async i=>{const d=document.getElementById("progress-container"),l=document.getElementById("progress-bar"),u=document.getElementById("progress-text");d.style.display="block",l.style.width="0%",u.textContent="正在解析日志文件...",await new Promise(r=>requestAnimationFrame(r));try{await new Promise(t=>setTimeout(t,0));const r=i.data;O=r.split(`
`);const a=O.length;u.textContent="正在解析日志内容...",T=await new Promise(t=>{setTimeout(()=>{const m=K(r);l.style.width="30%",t(m)},0)}),u.textContent="正在处理关键字...",await new Promise(t=>setTimeout(t,0));const n=new Set;for(let t=0;t<T.length;t++){T[t].keywords.forEach(s=>n.add(s));const h=Math.round(30+t/T.length*30);l.style.width=`${h}%`,t%10===0&&await new Promise(s=>setTimeout(s,0))}u.textContent="正在更新界面...",l.style.width="60%",await new Promise(t=>setTimeout(t,0)),$.innerHTML="",q.innerHTML="",E=new Map,n.forEach(t=>E.set(t,!0));let o=0;const c=n.size;for(const t of n){const m=document.createElement("span");m.className="filter-tag active",m.textContent=t,m.onclick=()=>{const s=E.get(t);E.set(t,!s),m.className=`filter-tag ${s?"inactive":"active"}`,D()},$.appendChild(m),o++;const h=Math.round(60+o/c*20);l.style.width=`${h}%`,o%5===0&&await new Promise(s=>setTimeout(s,0))}u.textContent="正在渲染内容...",l.style.width="80%",await new Promise(t=>setTimeout(t,0)),D(),l.style.width="100%",u.textContent="处理完成",setTimeout(()=>{d.style.display="none"},1e3)}catch(r){console.error("Error processing log:",r),u.textContent="处理出错: "+r.message,l.style.backgroundColor="#ff4444",setTimeout(()=>{d.style.display="none"},3e3)}});function j(i){P.innerHTML="";const d=document.createElement("div");d.className="block-header";const l=i.endLine-i.startLine+1,u=l>=500?" (Truncated to 500 lines)":"";if(d.textContent=`Log Block (Lines ${i.startLine+1} - ${i.endLine+1})${u}`,P.appendChild(d),O.slice(i.startLine,i.endLine+1).forEach((a,n)=>{const o=document.createElement("div"),c=i.startLine+n;o.id=`line-${c}`,o.innerHTML=`<span class="line-number">${c+1}</span>${a}`,i.keywords.some(t=>E.get(t)&&a.includes(t))&&o.classList.add("highlight"),P.appendChild(o)}),l>=500){const a=document.createElement("div");a.className="truncate-note",a.style.color="#666",a.style.padding="10px",a.style.fontStyle="italic",a.textContent="Note: Log block has been truncated to 500 lines for better performance.",P.appendChild(a)}}function D(){const i=document.getElementById("log-display"),d=document.getElementById("keyword-list"),l=document.getElementById("filter-container");i.innerHTML="",d.innerHTML="",l.innerHTML="";const u=new Set;T.forEach(n=>{n.keywords.forEach(o=>u.add(o))}),u.forEach(n=>{const o=document.createElement("span");o.className=`filter-tag ${E.get(n)?"active":"inactive"}`,o.textContent=n,o.onclick=()=>{document.querySelectorAll(".filter-tag").forEach(c=>{c.className="filter-tag inactive"}),o.className="filter-tag active",E.forEach((c,t)=>{E.set(t,t===n)}),D(),R(n)},l.appendChild(o)});const r=new Map,a=new Map;T.forEach(n=>{const o=V(n);r.has(o)||(r.set(o,n),n.keywords.forEach(c=>{a.has(c)||a.set(c,[]),a.get(c).push(n)}))}),a.forEach((n,o)=>{if(E.get(o)){const c=document.createElement("div");c.className="keyword-block";const t=document.createElement("div");t.className="keyword",t.textContent=o,c.appendChild(t);const m=document.createElement("div");m.className="keyword-tags",n.forEach(h=>{const s=document.createElement("span");s.className="keyword-tag",s.textContent=`行 ${h.startLine+1}`,h.duplicateCount>1&&(s.textContent+=` (${h.duplicateCount}次)`),s.onclick=()=>{document.querySelectorAll(".keyword-tag").forEach(y=>{y.classList.remove("active")}),s.classList.add("active"),j(h),R(o)},m.appendChild(s)}),c.appendChild(m),d.appendChild(c)}}),r.forEach(n=>{if(n.keywords.some(o=>E.get(o))){const o=document.createElement("div");if(o.className="log-block",n.duplicateCount>1){const t=document.createElement("div");t.className="duplicate-info",t.textContent=`此日志模式重复出现 ${n.duplicateCount} 次`,o.appendChild(t)}const c=document.createElement("pre");c.textContent=n.lines.join(`
`),o.appendChild(c),i.appendChild(o)}})}function R(i){document.querySelectorAll(".highlight").forEach(l=>{l.classList.remove("highlight")}),document.querySelectorAll("#log-display div").forEach(l=>{l.innerText.includes(i)&&l.classList.add("highlight")})}function V(i){return i.lines.map(l=>l.replace(/\[\d{4}-\d{2}-\d{2}\s+\d{2}:\d{2}:\d{2}.\d+\]/g,"").replace(/\d+\.\d+/g,"X.X").replace(/\[\d+\]/g,"[X]").replace(/pid:\d+/g,"pid:X").replace(/0x[0-9a-fA-F]+/g,"0xX").replace(/\b\d+\b/g,"X").trim().replace(/\s+/g," ")).join(`
`)}document.addEventListener("DOMContentLoaded",()=>{const i=document.getElementById("analyze-btn");i&&i.addEventListener("click",Y),U()});async function Y(){var y,S,A,x;const d=document.getElementById("model-selector").value,l=document.getElementById("log-display"),u=document.getElementById("analysis-result"),r=document.getElementById("analyze-btn");M&&M.abort(),M=new AbortController;const a=(y=document.querySelector(".filter-tag.active"))==null?void 0:y.textContent;if(!a){u.innerHTML='<div class="markdown">请先选择一个错误关键字</div>';return}const n=(S=document.querySelector(".highlight"))==null?void 0:S.innerText;if(!n){u.innerHTML='<div class="markdown">未找到对应的错误行</div>';return}const o=Array.from(l.children).map(w=>w.innerText),c=o.findIndex(w=>w===n),t=Math.max(0,c-5),m=Math.min(o.length,c+5),h=o.slice(t,m),s=`
            错误关键字: ${a}
            错误行: ${n}
            上下文:
            ${h.join(`
`)}`;console.log(`开始分析日志，选择的模型: ${d}`),r.disabled=!0,r.textContent="分析中...";try{const w=d==="local"?"http://localhost:8080":"http://localhost:8000",e=d==="local"?"/v1/chat/completions":`/api/analyze-log/${d}`,g=`${w}${e}`,p=G("defaultLogAnalysis");let f;d==="local"?f={messages:[{role:"system",content:p},{role:"user",content:s}],stream:!0}:f={content:s,prompt:p},u.innerHTML='<div class="markdown">正在分析中...</div>';let L="";const k=await fetch(g,{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream"},body:JSON.stringify(f),signal:M.signal});if(!k.ok)throw new Error(`HTTP error! status: ${k.status}`);const I=k.body.getReader(),C=new TextDecoder;for(;;){const{value:N,done:B}=await I.read();if(B)break;const _=C.decode(N,{stream:!0}).split(`
`);for(const F of _)if(F.startsWith("data: "))try{const v=JSON.parse(F.slice(5));if(v.error)throw new Error(v.error);if(v.choices&&((x=(A=v.choices[0])==null?void 0:A.delta)!=null&&x.content)){const z=v.choices[0].delta.content;L+=z;const W=J.render(L);u.innerHTML=`<div class="markdown">${W}</div>`}}catch(v){if(v.name!=="SyntaxError")throw console.error("解析响应数据错误:",v),v}}}catch(w){console.error("分析错误:",w),u.innerHTML=`<div class="markdown">分析出错: ${w.message}</div>`}finally{r.disabled=!1,r.textContent="分析日志",M=null}}function U(){const i=document.querySelector(".resizer"),d=document.getElementById("log-display"),l=document.getElementById("analysis-result"),u=document.querySelector(".split-container");let r,a;const n=document.createElement("div");n.className="resize-overlay",document.body.appendChild(n);function o(m){r=m.clientY,a=d.offsetHeight,l.offsetHeight,n.style.display="block",document.addEventListener("mousemove",c),document.addEventListener("mouseup",t),i.style.cursor="row-resize"}function c(m){const h=m.clientY-r,s=u.offsetHeight-i.offsetHeight,y=Math.max(100,Math.min(a+h,s-100)),S=s-y;y>=100&&S>=100&&(d.style.height=`${y}px`,l.style.height=`${S}px`)}function t(){n.style.display="none",document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",t),i.style.cursor="row-resize"}i.addEventListener("mousedown",o)}</script>
</head>

<body>
    <h1>Analyzer Result</h1>
    <div id="filter-container"></div>
    <div id="container">
        <div id="keyword-list"></div>
        <div class="right-panel">
            <div class="control-panel">
                <select id="model-selector" class="select select-bordered">
                    <option value="local">本地模型</option>
                    <option value="openai">OpenAI</option>
                    <option value="deepseek">DeepSeek</option>
                </select>
                <button id="analyze-btn" class="btn btn-primary">分析日志</button>
            </div>
            <div class="split-container">
                <div id="log-display"></div>
                <div class="resizer"></div>
                <div id="analysis-result">Analysis results will be displayed here.</div>
            </div>
        </div>
    </div>

    <!-- 添加进度条HTML -->
    <div class="progress-container" id="progress-container">
        <div class="progress-bar" id="progress-bar"></div>
        <div class="progress-text" id="progress-text">正在解析日志...</div>
    </div>

</body>

</html>